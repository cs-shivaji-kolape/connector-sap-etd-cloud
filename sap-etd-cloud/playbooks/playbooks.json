{
  "type": "workflow_collections",
  "data": [
    {
      "uuid": "ce7bd1cf-0a7e-4bdf-96e0-d1a381872c43",
      "@type": "WorkflowCollection",
      "name": "Sample - SAP Enterprise Threat Detection Cloud Edition - 1.0.0",
      "description": "SAP Enterprise Threat Detection (ETD), Cloud Edition helps you to identify the real attacks as they are happening and analyze the threats quickly enough to neutralize them before serious damage occurs. SAP Enterprise Threat Detection Cloud Edition connector performs action like get and ingest Events, Alerts and Investigations.",
      "visible": true,
      "image": null,
      "recordTags": [
        "sap-etd-cloud"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "uuid": "c4ed80b5-b942-4773-82ad-b57749e990e3",
          "collection": "/api/3/workflow_collections/ce7bd1cf-0a7e-4bdf-96e0-d1a381872c43",
          "triggerLimit": null,
          "description": "Retrive alerts based on start and end date/time.",
          "name": "Get Alerts",
          "tag": "#SAP Enterprise Threat Detection Cloud Edition",
          "recordTags": [
            "sap-etd-cloud"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/a945fd9a-92bc-48ec-8e04-41f3d3eed2dd",
          "steps": [
            {
              "uuid": "a945fd9a-92bc-48ec-8e04-41f3d3eed2dd",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "e9d960e7-249c-41d6-b2c8-fc2abdb24044",
                "title": "SAP Enterprise Threat Detection Cloud Edition: Get Alerts",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "9147206f-d33c-4e35-b3a2-adca20637405",
              "@type": "WorkflowStep",
              "name": "Get Alerts",
              "description": null,
              "status": null,
              "arguments": {
                "name": "SAP Enterprise Threat Detection Cloud Edition",
                "config": "''",
                "params": {
                  "limit": 10
                },
                "version": "1.0.0",
                "connector": "sap-etd-cloud",
                "operation": "get_alerts",
                "operationTitle": "Get Alerts",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "9c0cee0d-5c4a-49b9-a775-05f212b19971",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Alerts",
              "sourceStep": "/api/3/workflow_steps/a945fd9a-92bc-48ec-8e04-41f3d3eed2dd",
              "targetStep": "/api/3/workflow_steps/9147206f-d33c-4e35-b3a2-adca20637405"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "eeb2d317-011b-4b9d-aea5-5c0c86d41538",
          "collection": "/api/3/workflow_collections/ce7bd1cf-0a7e-4bdf-96e0-d1a381872c43",
          "triggerLimit": null,
          "description": "Get Alerts by specified ID",
          "name": "Get Alert Details by ID",
          "tag": "#SAP Enterprise Threat Detection Cloud Edition",
          "recordTags": [
            "sap-etd-cloud"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/e6410138-803b-4225-a0fd-73bd5262d3e9",
          "steps": [
            {
              "uuid": "e6410138-803b-4225-a0fd-73bd5262d3e9",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "32577cdd-8e62-48d2-b7d8-b24b2bf49659",
                "title": "SAP Enterprise Threat Detection Cloud Edition: Get Alert Details by ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "e268d255-aef0-499f-a19a-8329ee590e84",
              "@type": "WorkflowStep",
              "name": "Get Alert Details by ID",
              "description": null,
              "status": null,
              "arguments": {
                "name": "SAP Enterprise Threat Detection Cloud Edition",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "sap-etd-cloud",
                "operation": "get_alert_by_id",
                "operationTitle": "Get Alert Details by ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "15adbef0-70bf-4fbb-910a-35ee9083a16b",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Alert Details by ID",
              "sourceStep": "/api/3/workflow_steps/e6410138-803b-4225-a0fd-73bd5262d3e9",
              "targetStep": "/api/3/workflow_steps/e268d255-aef0-499f-a19a-8329ee590e84"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "95efd50e-ccb5-4760-875c-061b3c0b58e3",
          "collection": "/api/3/workflow_collections/ce7bd1cf-0a7e-4bdf-96e0-d1a381872c43",
          "triggerLimit": null,
          "description": "Get alerts with expansion and filter for investigations",
          "name": "Get Investigations",
          "tag": "#SAP Enterprise Threat Detection Cloud Edition",
          "recordTags": [
            "sap-etd-cloud"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/6c2fe01b-5b5d-4669-b736-68f6955b5b6e",
          "steps": [
            {
              "uuid": "6c2fe01b-5b5d-4669-b736-68f6955b5b6e",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "fd44b15a-edd3-40ba-8734-20a84a8ca449",
                "title": "SAP Enterprise Threat Detection Cloud Edition: Get Investigations",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "ee3286fd-7b58-40b4-83eb-0d108d737854",
              "@type": "WorkflowStep",
              "name": "Get Investigations",
              "description": null,
              "status": null,
              "arguments": {
                "name": "SAP Enterprise Threat Detection Cloud Edition",
                "config": "''",
                "params": {
                  "limit": 10
                },
                "version": "1.0.0",
                "connector": "sap-etd-cloud",
                "operation": "get_investigations",
                "operationTitle": "Get Investigations",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "ca7c602c-1d2d-44e2-a2db-360425f20eb8",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Investigations",
              "sourceStep": "/api/3/workflow_steps/6c2fe01b-5b5d-4669-b736-68f6955b5b6e",
              "targetStep": "/api/3/workflow_steps/ee3286fd-7b58-40b4-83eb-0d108d737854"
            }
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> SAP ETD CE > Create Record",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "source_data"
          ],
          "synchronous": false,
          "lastModifyDate": 1718201781,
          "collection": "/api/3/workflow_collections/ce7bd1cf-0a7e-4bdf-96e0-d1a381872c43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5304fb40-65bc-48e8-821b-80026b7df55f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Alert Record",
              "description": null,
              "arguments": {
                "resource": {
                  "name": "{{vars.alert_data.PatternName}}",
                  "type": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                  "state": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                  "status": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                  "severity": "/api/3/picklists/58d0753f-f7e4-403b-953c-b0f521eab759",
                  "sourceId": "{{vars.alert_data.AlertId}}",
                  "__replace": "",
                  "sourcedata": "{{vars.alert_data | toJSON }}",
                  "description": "{{vars.alert_data.PatternDescription}}",
                  "ackSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "respSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "priorityWeight": 1,
                  "escalatedtoincident": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                  "resolvedAutomatedly": false,
                  "alertRemainingAckSLA": 0
                },
                "operation": "Overwrite",
                "collection": "/api/3/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "c54dc457-5d39-4a8f-9540-f3f30a7141f9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Alert information",
              "description": null,
              "arguments": {
                "alert_data": "{{vars.input.params['source_data']}}"
              },
              "status": null,
              "top": "200",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "9278c866-e0e0-45af-8a49-ff0c4293d802"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                  "input": {
                    "params": []
                  }
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "5304fb40-65bc-48e8-821b-80026b7df55f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Extract Alert information -> Create Alert Record",
              "targetStep": "/api/3/workflow_steps/c54dc457-5d39-4a8f-9540-f3f30a7141f9",
              "sourceStep": "/api/3/workflow_steps/9278c866-e0e0-45af-8a49-ff0c4293d802",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "49e2d91e-1015-45f0-829b-594fd4add655"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Extract Alert information",
              "targetStep": "/api/3/workflow_steps/9278c866-e0e0-45af-8a49-ff0c4293d802",
              "sourceStep": "/api/3/workflow_steps/5304fb40-65bc-48e8-821b-80026b7df55f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "92cb61c6-4d45-46a5-82a7-9ae252291fee"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "8731ef10-d028-415d-b12b-8af7799ee574",
          "id": 3457,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "create",
            "dataingestion",
            "SAP",
            "sap-etd-cloud"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "SAP ETD CE > Ingest",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1718200112,
          "collection": "/api/3/workflow_collections/ce7bd1cf-0a7e-4bdf-96e0-d1a381872c43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/af82f4ae-8996-44a0-a431-d3fc502fd5f4",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Alerts.result_data.value}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "source_data": "{{vars.item}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/8731ef10-d028-415d-b12b-8af7799ee574"
              },
              "status": null,
              "top": "180",
              "left": "440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "1c9054af-6f1e-437b-8071-3f740a3f6c8a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Alerts",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/d16b2f16-7f91-4ef5-8199-ad533ca892f1"
              },
              "status": null,
              "top": "180",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "447a3aad-6766-4cbe-98aa-301ffc3b2a5f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "04596d8a-740d-4bc4-a291-2ebf62075bca",
                "resources": [
                  "alerts"
                ],
                "__triggerLimit": true,
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "triggerOnSource": true,
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "showToasterMessage": {
                  "visible": false,
                  "messageVisible": true
                },
                "triggerOnReplicate": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "af82f4ae-8996-44a0-a431-d3fc502fd5f4"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Get Alerts -> Create Record",
              "targetStep": "/api/3/workflow_steps/1c9054af-6f1e-437b-8071-3f740a3f6c8a",
              "sourceStep": "/api/3/workflow_steps/447a3aad-6766-4cbe-98aa-301ffc3b2a5f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e60681b8-8428-4e55-bfe0-1c6dea5cd14d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Alerts",
              "targetStep": "/api/3/workflow_steps/447a3aad-6766-4cbe-98aa-301ffc3b2a5f",
              "sourceStep": "/api/3/workflow_steps/af82f4ae-8996-44a0-a431-d3fc502fd5f4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "21afa280-1c97-4f30-a55e-8ca3fd6fef6c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "bf8a7e37-8b14-427f-961a-4484054b2edf",
          "id": 3456,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "SAP",
            "sap-etd-cloud"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> SAP ETD CE > Fetch",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1718195018,
          "collection": "/api/3/workflow_collections/ce7bd1cf-0a7e-4bdf-96e0-d1a381872c43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/dca9a8b2-767c-4f69-8e8e-6bdc6e251b02",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "check if macro exists",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/24cb79ac-4f82-42e1-8b0d-d5eb81d141cb",
                    "condition": "{{ vars.steps.Get_Last_Pull_Time.data['hydra:totalItems'] == 0 }}",
                    "step_name": "Create Macro"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/7cc34078-78c5-406e-b356-c22f9880060d",
                    "step_name": "Fetch current macro value"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "200",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": "/api/3/workflow_groups/63876778-8bdc-42d6-a53c-68fd382fd2b7",
              "uuid": "7dffb61b-9ac5-4a80-a5e7-4a69f359e510"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "batchSize": "100",
                "fetchTime": "{{arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss.ssss')}}Z",
                "defaultMinutes": "30",
                "pullTimeMacroName": "SAPETDPCELastPullTime",
                "macroNameForLastPullTime": "SAPETDPCELastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "165",
              "left": "327",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "3111f5ea-a902-4f95-b51c-fa25e511f642"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Macro",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json",
                  "body": "{ 'name': '{{vars.macroNameForLastPullTime}}'   , 'value':'0' }",
                  "method": "POST"
                },
                "version": "3.3.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "360",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": "/api/3/workflow_groups/63876778-8bdc-42d6-a53c-68fd382fd2b7",
              "uuid": "24cb79ac-4f82-42e1-8b0d-d5eb81d141cb"
            },
            {
              "@type": "WorkflowStep",
              "name": "Debug",
              "description": null,
              "arguments": {
                "lastPullTime": "{{vars.macroExistingRecord.value}}",
                "lastFetchTime": "{{vars.fetchTime}}"
              },
              "status": null,
              "top": "1020",
              "left": "340",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "7133ec71-be2d-496c-a094-570d1d167e6f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch current macro value",
              "description": null,
              "arguments": {
                "macroExistingRecord": "{{vars.steps.Get_Last_Pull_Time.data['hydra:member'][0]}}"
              },
              "status": null,
              "top": "360",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": "/api/3/workflow_groups/63876778-8bdc-42d6-a53c-68fd382fd2b7",
              "uuid": "7cc34078-78c5-406e-b356-c22f9880060d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Alerts",
              "description": null,
              "arguments": {
                "name": "SAP Enterprise Threat Detection Cloud Editon",
                "config": "a6d671a4-81a4-4334-a3a9-b6227415e1ac",
                "params": {
                  "limit": "{{vars.batchSize}}",
                  "endTime": "{{vars.fetchTime}}",
                  "startTime": "{{vars.lastPullTime}}"
                },
                "version": "1.0.0",
                "connector": "sap-etd-cloud",
                "operation": "get_alerts",
                "operationTitle": "Get Alerts",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "1020",
              "left": "1220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0c658345-c9d5-425b-a691-1c8dd0bc89be"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Last Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.macroNameForLastPullTime}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.3.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "60",
              "left": "200",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": "/api/3/workflow_groups/63876778-8bdc-42d6-a53c-68fd382fd2b7",
              "uuid": "3eefa56e-8c3b-4343-8736-eb0e8489948f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Data",
              "description": null,
              "arguments": {
                "result_data": "{{vars.steps.Get_Alerts.data}}"
              },
              "status": null,
              "top": "1040",
              "left": "1611",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "627bbf6e-bc2c-40d8-b09a-f5ae090518f3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n        {\n          \"title\": \"Limit\",\n          \"name\": \"batchSize\",\n          \"visible\": true,\n          \"required\": false,\n          \"editable\": true,\n          \"type\": \"text\",\n          \"tooltip\": \"Defines the number of alerts included. Default value: 100\",\n          \"description\": \"Defines the number of alerts included. The default batch size is 100.\"\n        },\n        {\n          \"title\": \"Pull Alerts Created in Past X Minutes\",\n          \"name\": \"minutes\",\n          \"type\": \"text\",\n          \"tooltip\": \"Pull the alerts created in the past X minutes.\",\n          \"required\": false,\n          \"editable\": true,\n          \"visible\": true,\n          \"value\": \"5\"\n        }\n]"
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
              },
              "status": null,
              "top": "30",
              "left": "327",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "dca9a8b2-767c-4f69-8e8e-6bdc6e251b02"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.macroNameForLastPullTime}}",
                  "value": "{{vars.lastFetchTime}}"
                },
                "version": "3.3.1",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create/Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "1020",
              "left": "800",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "385773c7-a087-4c9e-b521-55a21be705b2"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "check if macro exists -> Create Macro",
              "targetStep": "/api/3/workflow_steps/24cb79ac-4f82-42e1-8b0d-d5eb81d141cb",
              "sourceStep": "/api/3/workflow_steps/7dffb61b-9ac5-4a80-a5e7-4a69f359e510",
              "label": "No",
              "isExecuted": false,
              "group": null,
              "uuid": "94ebb816-9e89-4bbb-80a2-77ad25ee4104"
            },
            {
              "@type": "WorkflowRoute",
              "name": "check if macro exists -> Fetch current macro value",
              "targetStep": "/api/3/workflow_steps/7cc34078-78c5-406e-b356-c22f9880060d",
              "sourceStep": "/api/3/workflow_steps/7dffb61b-9ac5-4a80-a5e7-4a69f359e510",
              "label": "Yes",
              "isExecuted": false,
              "group": null,
              "uuid": "5f1a2d1a-8e65-4d36-a1a2-667c62bc607b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Last Pull Time",
              "targetStep": "/api/3/workflow_steps/3eefa56e-8c3b-4343-8736-eb0e8489948f",
              "sourceStep": "/api/3/workflow_steps/3111f5ea-a902-4f95-b51c-fa25e511f642",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "6f9d675d-c21e-46e9-a1ff-ec24a117621d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Macro -> Debug",
              "targetStep": "/api/3/workflow_steps/7133ec71-be2d-496c-a094-570d1d167e6f",
              "sourceStep": "/api/3/workflow_steps/24cb79ac-4f82-42e1-8b0d-d5eb81d141cb",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a7019a21-128f-471b-bb93-3fe42ae77c6a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Debug -> Update Last Pull Time",
              "targetStep": "/api/3/workflow_steps/385773c7-a087-4c9e-b521-55a21be705b2",
              "sourceStep": "/api/3/workflow_steps/7133ec71-be2d-496c-a094-570d1d167e6f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "01f2f740-a86d-4773-86f4-83704444f821"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch current macro value -> Debug",
              "targetStep": "/api/3/workflow_steps/7133ec71-be2d-496c-a094-570d1d167e6f",
              "sourceStep": "/api/3/workflow_steps/7cc34078-78c5-406e-b356-c22f9880060d",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4fa4a22e-d873-4351-8679-d8dc0f15a40a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Alerts -> Return Data",
              "targetStep": "/api/3/workflow_steps/627bbf6e-bc2c-40d8-b09a-f5ae090518f3",
              "sourceStep": "/api/3/workflow_steps/0c658345-c9d5-425b-a691-1c8dd0bc89be",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e1cf9734-6e26-4748-81ec-b13cce5a2613"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Last Pull Time -> check if macro exists",
              "targetStep": "/api/3/workflow_steps/7dffb61b-9ac5-4a80-a5e7-4a69f359e510",
              "sourceStep": "/api/3/workflow_steps/3eefa56e-8c3b-4343-8736-eb0e8489948f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a942b1ed-b4a1-4942-ab2f-847a5214d511"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/3111f5ea-a902-4f95-b51c-fa25e511f642",
              "sourceStep": "/api/3/workflow_steps/dca9a8b2-767c-4f69-8e8e-6bdc6e251b02",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "23c3cef0-918a-45e5-9d7f-0cba99803713"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Last Pull Time -> Get Alerts",
              "targetStep": "/api/3/workflow_steps/0c658345-c9d5-425b-a691-1c8dd0bc89be",
              "sourceStep": "/api/3/workflow_steps/385773c7-a087-4c9e-b521-55a21be705b2",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b2a90f12-6a31-4388-a38f-fb68aacca1b5"
            }
          ],
          "groups": [
            {
              "@type": "WorkflowGroup",
              "name": "PullTime Macro",
              "description": "",
              "type": "block",
              "isCollapsed": false,
              "hasTriggerStep": false,
              "hideInLogs": false,
              "metadata": [],
              "reusable": false,
              "top": "420",
              "left": "140",
              "height": "476",
              "width": "654",
              "uuid": "63876778-8bdc-42d6-a53c-68fd382fd2b7",
              "recordTags": []
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "d16b2f16-7f91-4ef5-8199-ad533ca892f1",
          "id": 3449,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "SAP",
            "sap-etd-cloud"
          ]
        }
      ]
    }
  ]
}